/**
 * skylark-pako - A skylark wrapper for pako.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx-compression/deflates","skylark-langx-compression/messages","skylark-langx-compression/zstream","skylark-langx-compression/constants","./utils/common","./utils/strings"],function(t,i,n,e,s,r){"use strict";const o=Object.prototype.toString,{Z_NO_FLUSH:a,Z_SYNC_FLUSH:u,Z_FULL_FLUSH:l,Z_FINISH:h,Z_OK:c,Z_STREAM_END:d,Z_DEFAULT_COMPRESSION:f,Z_DEFAULT_STRATEGY:_,Z_DEFLATED:p}=e;function w(e){this.options=s.assign({level:f,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:_},e||{});let a=this.options;a.raw&&a.windowBits>0?a.windowBits=-a.windowBits:a.gzip&&a.windowBits>0&&a.windowBits<16&&(a.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new n,this.strm.avail_out=0;let u=t.deflateInit2(this.strm,a.level,a.method,a.windowBits,a.memLevel,a.strategy);if(u!==c)throw new Error(i[u]);if(a.header&&t.deflateSetHeader(this.strm,a.header),a.dictionary){let n;if(n="string"==typeof a.dictionary?r.string2buf(a.dictionary):"[object ArrayBuffer]"===o.call(a.dictionary)?new Uint8Array(a.dictionary):a.dictionary,(u=t.deflateSetDictionary(this.strm,n))!==c)throw new Error(i[u]);this._dict_set=!0}}function y(t,n){const e=new w(n);if(e.push(t,!0),e.err)throw e.msg||i[e.err];return e.result}return w.prototype.push=function(i,n){const e=this.strm,s=this.options.chunkSize;let f,_;if(this.ended)return!1;for(_=n===~~n?n:!0===n?h:a,"string"==typeof i?e.input=r.string2buf(i):"[object ArrayBuffer]"===o.call(i)?e.input=new Uint8Array(i):e.input=i,e.next_in=0,e.avail_in=e.input.length;;)if(0===e.avail_out&&(e.output=new Uint8Array(s),e.next_out=0,e.avail_out=s),(_===u||_===l)&&e.avail_out<=6)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else{if((f=t.deflate(e,_))===d)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),f=t.deflateEnd(this.strm),this.onEnd(f),this.ended=!0,f===c;if(0!==e.avail_out){if(_>0&&e.next_out>0)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else if(0===e.avail_in)break}else this.onData(e.output)}return!0},w.prototype.onData=function(t){this.chunks.push(t)},w.prototype.onEnd=function(t){t===c&&(this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},{Deflate:w,deflate:y,deflateRaw:function(t,i){return(i=i||{}).raw=!0,y(t,i)},gzip:function(t,i){return(i=i||{}).gzip=!0,y(t,i)},constants:e}});
//# sourceMappingURL=sourcemaps/deflates.js.map
