/**
 * skylark-pako - A skylark wrapper for pako.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./zlib/deflate","./utils/common","./utils/strings","./zlib/messages","./zlib/zstream","./zlib/constants"],function(t,i,e,n,s,r){"use strict";const o=Object.prototype.toString,{Z_NO_FLUSH:a,Z_SYNC_FLUSH:u,Z_FULL_FLUSH:h,Z_FINISH:l,Z_OK:d,Z_STREAM_END:f,Z_DEFAULT_COMPRESSION:c,Z_DEFAULT_STRATEGY:_,Z_DEFLATED:w}=r;function p(r){this.options=i.assign({level:c,method:w,chunkSize:16384,windowBits:15,memLevel:8,strategy:_},r||{});let a=this.options;a.raw&&a.windowBits>0?a.windowBits=-a.windowBits:a.gzip&&a.windowBits>0&&a.windowBits<16&&(a.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;let u=t.deflateInit2(this.strm,a.level,a.method,a.windowBits,a.memLevel,a.strategy);if(u!==d)throw new Error(n[u]);if(a.header&&t.deflateSetHeader(this.strm,a.header),a.dictionary){let i;if(i="string"==typeof a.dictionary?e.string2buf(a.dictionary):"[object ArrayBuffer]"===o.call(a.dictionary)?new Uint8Array(a.dictionary):a.dictionary,(u=t.deflateSetDictionary(this.strm,i))!==d)throw new Error(n[u]);this._dict_set=!0}}function y(t,i){const e=new p(i);if(e.push(t,!0),e.err)throw e.msg||n[e.err];return e.result}return p.prototype.push=function(i,n){const s=this.strm,r=this.options.chunkSize;let c,_;if(this.ended)return!1;for(_=n===~~n?n:!0===n?l:a,"string"==typeof i?s.input=e.string2buf(i):"[object ArrayBuffer]"===o.call(i)?s.input=new Uint8Array(i):s.input=i,s.next_in=0,s.avail_in=s.input.length;;)if(0===s.avail_out&&(s.output=new Uint8Array(r),s.next_out=0,s.avail_out=r),(_===u||_===h)&&s.avail_out<=6)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else{if((c=t.deflate(s,_))===f)return s.next_out>0&&this.onData(s.output.subarray(0,s.next_out)),c=t.deflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===d;if(0!==s.avail_out){if(_>0&&s.next_out>0)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else if(0===s.avail_in)break}else this.onData(s.output)}return!0},p.prototype.onData=function(t){this.chunks.push(t)},p.prototype.onEnd=function(t){t===d&&(this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},{Deflate:p,deflate:y,deflateRaw:function(t,i){return(i=i||{}).raw=!0,y(t,i)},gzip:function(t,i){return(i=i||{}).gzip=!0,y(t,i)},constants:r}});
//# sourceMappingURL=sourcemaps/deflates.js.map
