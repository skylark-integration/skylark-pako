/**
 * skylark-pako - A skylark wrapper for pako.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx-compression/inflates","skylark-langx-compression/messages","skylark-langx-compression/zstream","skylark-langx-compression/constants","./utils/common","./utils/strings"],function(t,i,n,s,o,e){"use strict";const r=Object.prototype.toString,{Z_NO_FLUSH:a,Z_FINISH:u,Z_OK:h,Z_STREAM_END:w,Z_NEED_DICT:c,Z_STREAM_ERROR:l,Z_DATA_ERROR:d,Z_MEM_ERROR:f}=s;function p(s){this.options=o.assign({chunkSize:65536,windowBits:15,to:""},s||{});const a=this.options;a.raw&&a.windowBits>=0&&a.windowBits<16&&(a.windowBits=-a.windowBits,0===a.windowBits&&(a.windowBits=-15)),!(a.windowBits>=0&&a.windowBits<16)||s&&s.windowBits||(a.windowBits+=32),a.windowBits>15&&a.windowBits<48&&0==(15&a.windowBits)&&(a.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new n,this.strm.avail_out=0;let u=t.inflateInit2(this.strm,a.windowBits);if(u!==h)throw new Error(i[u]);if(this.header=new GZheader,t.inflateGetHeader(this.strm,this.header),a.dictionary&&("string"==typeof a.dictionary?a.dictionary=e.string2buf(a.dictionary):"[object ArrayBuffer]"===r.call(a.dictionary)&&(a.dictionary=new Uint8Array(a.dictionary)),a.raw&&(u=t.inflateSetDictionary(this.strm,a.dictionary))!==h))throw new Error(i[u])}function _(t,n){const s=new p(n);if(s.push(t),s.err)throw s.msg||i[s.err];return s.result}return p.prototype.push=function(i,n){const s=this.strm,o=this.options.chunkSize,p=this.options.dictionary;let _,y,g;if(this.ended)return!1;for(y=n===~~n?n:!0===n?u:a,"[object ArrayBuffer]"===r.call(i)?s.input=new Uint8Array(i):s.input=i,s.next_in=0,s.avail_in=s.input.length;;){for(0===s.avail_out&&(s.output=new Uint8Array(o),s.next_out=0,s.avail_out=o),(_=t.inflate(s,y))===c&&p&&((_=t.inflateSetDictionary(s,p))===h?_=t.inflate(s,y):_===d&&(_=c));s.avail_in>0&&_===w&&s.state.wrap>0&&0!==i[s.next_in];)t.inflateReset(s),_=t.inflate(s,y);switch(_){case l:case d:case c:case f:return this.onEnd(_),this.ended=!0,!1}if(g=s.avail_out,s.next_out&&(0===s.avail_out||_===w))if("string"===this.options.to){let t=e.utf8border(s.output,s.next_out),i=s.next_out-t,n=e.buf2string(s.output,t);s.next_out=i,s.avail_out=o-i,i&&s.output.set(s.output.subarray(t,t+i),0),this.onData(n)}else this.onData(s.output.length===s.next_out?s.output:s.output.subarray(0,s.next_out));if(_!==h||0!==g){if(_===w)return _=t.inflateEnd(this.strm),this.onEnd(_),this.ended=!0,!0;if(0===s.avail_in)break}}return!0},p.prototype.onData=function(t){this.chunks.push(t)},p.prototype.onEnd=function(t){t===h&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},{Inflate:p,inflate:_,inflateRaw:function(t,i){return(i=i||{}).raw=!0,_(t,i)},ungzip:_,constants:s}});
//# sourceMappingURL=sourcemaps/inflates.js.map
